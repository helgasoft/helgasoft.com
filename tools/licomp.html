<html lang='en-US'>
<head>
	<meta charset='utf-8'>
	<title>Helgasoft - Compare Lists in JS</title>
	<link rel='shortcut icon' href='../favicon.ico' type='image/x-icon' />
	<meta name='description' content='Compare Lists Online'>
	<meta name="keywords" content="compare two lists online, compare lists online tool, Compare list differences, free" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Libs and Plugins CSS -->
	<link rel='stylesheet' href='../inc/bootstrap/css/bootstrap.min.css'>
	<link rel='stylesheet' href='../css/style.css'>

	<!-- Skin CSS -->
	<link rel='stylesheet' href='../css/skin/night-purple.css'>

<script type='text/javascript'>
// Copyright Â©  Helgasoft.com   All Rights Reserved

function clean(id) {
	// remove empty lines
	return document.getElementById(id).value.replace(/^\s*[\r\n]/gm, '').split('\n').filter(Boolean);
}
function sorta() {
	// sort all arrays
	document.getElementById('TextBox1').value = clean('TextBox1').sort().join('\n');
	document.getElementById('TextBox2').value = clean('TextBox2').sort().join('\n');
	document.getElementById('timer').innerText = '';
	document.getElementById('dupl1').value = clean('dupl1').sort().join('\n');
	document.getElementById('dupl2').value = clean('dupl2').sort().join('\n');
	document.getElementById('uniq1').value = clean('uniq1').sort().join('\n');
	document.getElementById('uniq2').value = clean('uniq2').sort().join('\n');
	document.getElementById('common').value = clean('common').sort().join('\n');
}
function deldup(me) {
	var startTime = Date.now();
	//var list1 = clean('TextBox1').filter(function(item, pos, self) { return self.indexOf(item) == pos; })
	//var list2 = clean('TextBox2').filter(function(item, pos, self) { return self.indexOf(item) == pos; })
	let list1 = [...new Set(clean('TextBox1'))];
	let list2 = [...new Set(clean('TextBox2'))];
	document.getElementById('TextBox1').value = list1.join('\n');
	document.getElementById('TextBox2').value = list2.join('\n');
	leni('TextBox1', 'lbl1');
	leni('TextBox2', 'lbl2');
	elapsed(startTime);
}
function getdup(lst) {
	// find duplicates
	var sorted = lst.slice().sort();
	var results = [];
	for (var i = 0; i < sorted.length - 1; i++) {
	    if (sorted[i + 1] == sorted[i]) { results.push(sorted[i]); }
	}
	return [...new Set(results)];
}
function compir() {
	// TODO: 'processing..' msg for long lists
	var startTime = Date.now();
	document.getElementById('btnGo').style.background = '#FBB';

	var list1 = clean('TextBox1')
	var list2 = clean('TextBox2')

	// find values that are in list1 but not in list2
	var tmp = list1.filter(function(obj) {
	    return !list2.some(function(obj2) {
	        return obj == obj2;
	    });
	});
	let uniqueResultOne = [...new Set(tmp)];

	// find values that are in list2 but not in list1
	tmp = list2.filter(function(obj) {
	    return !list1.some(function(obj2) {
	        return obj == obj2;
	    });
	});
	let uniqueResultTwo = [...new Set(tmp)];

	document.getElementById('uniq1').value = uniqueResultOne.join('\n');
	document.getElementById('uniq2').value = uniqueResultTwo.join('\n');
	leni('uniq1', 'lbl3');
	leni('uniq2', 'lbl4');

	// find duplicates
	document.getElementById('dupl1').value = getdup(list1).join('\n');
	document.getElementById('dupl2').value = getdup(list2).join('\n');
	leni('dupl1', 'lbl6');
	leni('dupl2', 'lbl7');
	
	// common values both in list2 and list1
	var tmp = list2.filter(function(obj) {
	    return list1.some(function(obj2) {
	        return obj == obj2;
	    });
	});
	let commonResult = [...new Set(tmp)];	
	document.getElementById('common').value = commonResult.join('\n');
	leni('common', 'lbl5');

	leni('TextBox1', 'lbl1');
	leni('TextBox2', 'lbl2');
	document.getElementById('btnGo').style.background = 'buttonface';
	elapsed(startTime);
}
function leni(meid,lbl) {
	var text = typeof(meid)=='string' ? document.getElementById(meid).value : document.getElementById(meid.id).value;
	if (text.length == 0) {
		document.getElementById(lbl).innerText = 'none';
		return;
	}
	var rows = text.split('\n').length;
	document.getElementById(lbl).innerText = rows + ' items'; 
}
function elapsed(st) {
   	var ms = Date.now() - st; //, min = (ms/1000/60) << 0, sec = (ms/1000) % 60;
	var sec = Math.floor(ms / 1000);
	var min = Math.floor(sec / 60);
	sec = sec - (min * 60);
	var timer = document.getElementById('timer');
	timer.innerText = (min*60+sec > 10) ? 'Finished in ' + min + ':' + pad(sec) + ' (min:sec)' : '';
}
function pad(n) { 
	if (n < 10 & n >=0) return ('0' + n); if(n < 0 & n > -11) return ('-0' + Math.abs(n)); return n; 
}

function readText(filePath, tarea) {
	if(filePath.value){
		filePath.className = '';
	} else {
		filePath.className = 'notext';
	}
	if(filePath.files && filePath.files[0]) {	// html5 filelist support
	  let reader = new FileReader();           
	  reader.onload = function (e) {
		document.getElementById(tarea).innerHTML = e.target.result;
	  };
	  reader.readAsText(filePath.files[0]);
	}
	else alert('browser has no html5 file support');
	return true;
}
</script>

<style>
	/* body { font: normal 16px Calibri, Verdana, Arial, sans-serif; }  */
	td { vertical-align:top; }
	table {
	    border-collapse: separate;
	    border-spacing: 10px;
	}
	.txt {font-size:small}
	.rslt {
	    display: table-cell;
	    border: solid #55A 1px;
	    border-style: solid none none none;
	    /* background-color:#AAF; */
	}
	button { margin-right: 20px; }
	button:active { border: solid #F55 2px; background:#FBB;}
	table.CoreTable
	{
	    border-collapse: collapse;
	    width: 90%;
	    text-align: center;
	}
	textarea { 
	    resize:both; max-height:500px; min-height:100px; 
	    /* border: none; */
	    width: 94%;
	    margin: 8px;
	    -webkit-box-sizing: border-box; /* <=iOS4, <= Android  2.3 */
	       -moz-box-sizing: border-box; /* FF1+ */
	            box-sizing: border-box; /* Chrome, IE8, Opera, Safari 5.1*/
	}
	p { margin: 30px; }
	span { border-radius: 10px !important; }
	.notext{
	 	color: transparent;
	}
	.blk { display:inline-block; }
</style>
</head>

<body>
        
	<!--========== BEGIN HEADER ==========-->
	<header id='header' class='header-main' style='height:98px;'>
	
	<!-- Begin Navbar -->
	<nav id='main-navbar' class='navbar navbar-default navbar-fixed-top' role='navigation'>
	
	  <div class='container'>
	
	    <!-- Brand and toggle get grouped for better mobile display -->
	    <div class='navbar-header'>
	      <a class='navbar-brand page-scroll' href='../'></a>
	    </div>
	
	    <!-- Collect the nav links, forms, and other content for toggling -->
	    <div class='collapse navbar-collapse' id='bs-example-navbar-collapse-1'>
	        <ul class='nav navbar-nav navbar-right'>
	            <li><a class='page-scroll' href='../#portfolio-section'>Back</a></li>
		</ul>
	    </div><!-- /.navbar-collapse -->
	  </div><!-- /.container -->
	</nav>
	<!-- End Navbar -->
	
	</header>
	<!-- ========= END HEADER =========-->


<div style='text-align:center'>
	<h5 style='display:inline;margin-right:30px'>Compare Lists</h5> 
</div>

<table border='0' class='CoreTable'>
  <tr>
	<td width='14%'><b>Input Lists</b></td>
	<td width='43%'><div class='blk'><b>First</b> &nbsp; &nbsp; &nbsp; type or </div> 
		<div class='blk'><input type='file' onchange="readText(this, 'TextBox1')" class='notext' /></div>  <br />
		<textarea id='TextBox1' onchange="leni(this,'lbl1')" tabindex=1 placeholder="paste one item per line"></textarea>
		<br /><span id="lbl1" class='badge'></span></td>
	<td><div class='blk'><b>Second</b> &nbsp; &nbsp; &nbsp; type or </div> 
		<div class='blk'><input type='file' onchange="readText(this, 'TextBox2')" class='notext' /></div> <br />
		<textarea id='TextBox2' onchange="leni(this,'lbl2')" tabindex=2 placeholder="paste one item per line"></textarea>
		<br /><span id='lbl2' class='badge'></span></td>
    	</tr>
  <tr>
	<td>&nbsp;</td>
	<td colspan=2 style='text-align:center; padding:10;'>
		<button onclick='sorta()' >sort all</button>
		<button onclick='deldup(this)' >delete duplicates</button>
		<button onclick='compir()' tabindex=3 id='btnGo'><b>Compare</b></button>
		<br /><div id='timer' class='txt'></div>
	</td>
	</tr>
  <tr>
	<td>&nbsp;</td>
	<td colspan=2 class='rslt'></td></tr>
  <tr>
	<td><b>Unique</b> </td>
        <td><textarea id='uniq1'></textarea><br /><span id='lbl3' class='badge'></span></td>
        <td><textarea id='uniq2'></textarea><br /><span id='lbl4' class='badge'></span></td></tr>
  <tr>
	<td><b>Duplicated</b><br /><div class='txt'>once or more</div> </td>
        <td><textarea id='dupl1'></textarea><br /><span id='lbl6' class='badge'></span></td>
        <td><textarea id='dupl2'></textarea><br /><span id='lbl7' class='badge'></span></td>
	</tr>
  <tr>
	<td><b>Common</b></td>
        <td colspan=2>
		<div style='text-align:center'><textarea id='common' style='width:50% !important'></textarea><br />
		<span id='lbl5' class='badge'></span></div></td>
	</tr>
</table>

<p>&nbsp;<br />
<table border='0' class='CoreTable'>
  <tr>
	<td>
<b>Note</b>: Numerical items are converted to strings and compared/sorted as strings.<br />
Time estimate for 80K items lists on Intel i5 processor is ~2 minutes.<br />
Please do not interrupt when Compare button is <span style='color:#FF5555'>red</span>, browser is still working.<br />
If prompted, select <i>Wait</i> or <i>Continue</i> for processing to complete.
	</td><td>
If you like and use the application, please 
<br /><br /> 
<form action='https://www.paypal.com/cgi-bin/webscr' method='post' target='_top'>
<input type='hidden' name='cmd' value='_s-xclick'> <input type='hidden' name='hosted_button_id' value='6KJJ8ZPZZQSCJ'> <input type='image' src='../img/btn_donate_SM.gif' border='0' name='submit' alt='PayPal - The safer, easier way to pay online!'> <img alt='' border='0' src='https://www.paypalobjects.com/en_US/i/scr/pixel.gif' width='1' height='1'>
</form> 
	</td></tr>
</table>
</p>

</body>
</html>